# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On

# CloudFront経由でない場合のHTTPSリダイレクト
RewriteCond %{HTTP:X-Forwarded-Proto} !https
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^{{ wordpress_domain | default('example.com') | regex_replace('\.', '\.') }}$ [NC]
RewriteRule ^(.*)$ https://{{ wordpress_domain | default('example.com') }}/$1 [R=301,L]

RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress
